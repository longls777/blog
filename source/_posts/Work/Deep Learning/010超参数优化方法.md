---
title: 超参数优化方法
tags: 
categories: Deep Learning
date: 2023-7-23 14:59:00
index_img: http://longls777.oss-cn-beijing.aliyuncs.com/img/in81ouqsi8.gif
banner_img: http://longls777.oss-cn-beijing.aliyuncs.com/img/in81ouqsi8.gif
math: true
---

> https://aws.amazon.com/cn/what-is/hyperparameter-tuning/
>
> https://cloud.tencent.com/developer/article/1700820
>
> 机器学习模型的超参数优化 - deephub的文章 - 知乎 https://zhuanlan.zhihu.com/p/138005319



超参数优化是指在机器学习和深度学习等领域中，对于模型中的超参数进行搜索和调整，以找到最优的超参数组合，从而获得更好的模型性能。

超参数是在模型训练过程中需要手动设置的参数，不同于模型的权重。



## 网格搜索（Grid Search）

![网格搜索](http://longls777.oss-cn-beijing.aliyuncs.com/img/v2-b9bfaa5a05b99bf673ff530503e489c9_1440w.webp)

网格搜索是一种简单直观的超参数优化方法，它在预定义的超参数取值范围内进行穷举搜索，尝试所有可能的超参数组合，然后选择在验证集上表现最好的超参数组合作为最终的模型配置

**优点：**

- **简单易懂**

**缺点：**

- **计算成本较高，超参数数量较多时，搜索空间呈指数级增长；**
- **不能保证搜索会找到完美的超参数值**



## 随机搜索（Random Search）

![随机搜索](http://longls777.oss-cn-beijing.aliyuncs.com/img/v2-040c8fb5affc3054aa1dc6f1dd866708_1440w.webp)

使用随机搜索代替网格搜索的动机是，在许多情况下，所有的超参数可能并非同等重要。随机搜索从超参数空间中随机选择参数组合，参数按给定的迭代次数进行选择

随机搜索相对于网格搜索能够更准确地确定某些重要的超参数的最佳值

**优点：**

- **更高的搜索效率；**
- **适用于高维度和复杂的超参数空间**

**缺点：**

- **不保证全局最优解；**
- **无法根据之前的尝试来调整下一组超参数的采样方式；**
- **搜索效率不一致，不同地运行随机搜索可能会得到不同的超参数组合性能；**
- **忽略了超参数之间的相关性**



## 贝叶斯优化（Bayesian Optimization）

前面两种方法能够针对单独超参数组合模型进行训练，并评估各自的性能。每个模型都是独立的，因此很易于进行并行计算。但是每个模型都是独立的，也导致模型之间不具有指导意义，前一模型的计算结果并不能影响后一模型的超参数选择。 而贝叶斯优化方法（顺序优化方法的一种，sequential model-besed optimization，SMBO，用于解决黑盒函数优化问题）则**可以借鉴已有的结果进而影响后续的模型超参数选择**

贝叶斯优化的核心思想是通过构建一个代理模型（概率模型）来描述目标函数的不确定性，并根据先验信息和观测数据来更新模型，以指导下一次采样的策略。随着观测次数的增加，后验分布得到改善，算法更加确定参数空间中哪些区域值得探索，哪些区域不值得探索

该算法大致可以概括如下：

1. 使用先前计算过的点 $X_{1: n}$，计算损失 $f$ 的后验期望值；
2. 在一个新的点 $X_{n+1}$取样损失 $f$ ，它最大化了 $f$ 的期望的某些效用函数。该函数指定 $f$ 域的哪些区域是最适合采样的

重复这些步骤，直到达到某种收敛准则

![贝叶斯优化](http://longls777.oss-cn-beijing.aliyuncs.com/img/v2-ee05a773a738f4c2eb09fd4c47bf238f_1440w.webp)

优点：

- 对目标函数的采样高效且具有指导性，能够在较少次数的采样下找到全局最优解；
- 可以在高维度、非凸性和噪声存在的情况下表现出色；
- 具有良好的可解释性，能够提供目标函数的不确定性估计

缺点：

- 由于涉及到概率模型的构建和更新，相对于简单的优化方法，贝叶斯优化的实现较为复杂；
- 在目标函数的采样次数较少时，代理模型的准确性可能较低，导致预测性能不稳定；
- 贝叶斯优化的性能高度依赖于选择的核函数和先验分布，需要合理的先验知识